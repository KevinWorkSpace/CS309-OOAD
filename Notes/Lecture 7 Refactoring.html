<html>
<head>
  <title>Lecture 7 Refactoring</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/308816 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="2472"/>
<h1>Lecture 7 Refactoring</h1>

<div>
<span><div><div>What is Refactoring?</div><ul><li><div>Semantic-preserving program transformations(语义保留的程序转换)</div></li><li><div>Improving the design after the code has been written</div></li></ul><div><br/></div><div>Single Responsibility Principle</div><ul><li><div>one class should be responsible for only one piece of function</div></li></ul><div><br/></div><div>Divergent Change 发散式变化</div><ul><li><div>一个class收到多个变化的影响, 可以将这个class拆分成多个class, 让每个对象可以只因一种变化而需要修改</div></li></ul><div><br/></div><div>Shotgun Surgery 散弹式修改</div><ul><li><div>一种变化引发多个class相应修改. 可以将需要修改的地方放到一个class</div></li></ul><div><br/></div><div>Feature Envy 依恋情结</div><ul><li><div>某个函数从另一个对象调用很多的getting method, 可以把这个函数移到那个类中</div></li></ul><div><br/></div><div>Data Clumps 数据泥团</div><ul><li><div>将总是绑在一起出现的数据提炼到一个独立对象中</div></li></ul><div><br/></div><div>Primitive Obsession 基本类型偏执</div><ul><li><div>将基本类型替换成小型class</div></li><li><div>Classes generally provide a simpler and more natural way to directly model things than primitives do</div></li></ul><div><br/></div><div>Switch statements 少用switch语句</div><ul><li><div><span style="color: rgb(77, 77, 77); font-family: &quot;NoForceAllFonts By Plus.Func.Fonts.CN&quot;, &quot;NoForceAllFonts By 此处填写中文字体&quot;, &quot;NoForceAllFonts By DiyCnFEx&quot;, &quot;NoForceAllFonts By Microsoft YaHei&quot;, &quot;Catcat520.Lite.Latin&quot;, SDF-FixFontPos, SDF-FixFontPos-Space, LCnS, LEnS, LEnN, 此处填写英文字体, 此处填写font-family的名称, SDF-FixEnglishFonts, &quot;Segoe UI&quot;, Inconsolata, &quot;Envy Code R&quot;, &quot;Open Sans&quot;, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Lucida Grande&quot;, Ubuntu, Tahoma, Verdana, Menlo, Monaco, HighLevelEmoji, LCnS, &quot;/*UseJPFakeName By CnFonts&quot;, 此处填写中文字体, DiyCnFEx, &quot;SDF.FixScTcFonts&quot;, &quot;SDF.Hangul&quot;, &quot;Plus.Func.Fonts.CN&quot;, &quot;Microsoft YaHei&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, &quot;Microsoft JhengHei UI&quot;, &quot;Microsoft JhengHei&quot;, fp-font, AccessibilityFoundicons, &quot;Accessibility Foundicons&quot;, anchorjs-icons, Brandico, Brankic1979, &quot;Brankic 1979&quot;, Broccolidry, bundlestars, chagaan, CONDENSEicon, consumer-icons, Cuticons, dashicons, DA-brandicons, duotai, duotai-status, &quot;Dot Com&quot;, Ecoico, EightiesShades, ElegantIcons, Elusive, Elusive-Icons, Entypo, &quot;Entypo Social&quot;, Entypo-Social, &quot;Erler Dingbats&quot;, Et-line, FabricMDL2Icons, feedfont, FontAwesome, Fontelico, Fontello, Garqag, GeneralEnclosedFoundicons, &quot;General Enclosed Foundicons&quot;, GeneralFoundicons, &quot;General Foundicons&quot;, Gibson, &quot;Gibson Light&quot;, Gibson_lightbold, Gibson_lightitalic, Gibsonregular, &quot;Glyphicons Halflings&quot;, hb-icons, &quot;Heydings Controls&quot;, &quot;Heydings Icons&quot;, Houzz-Glyphs, icft_temai, icft_temai_index, Iconminia, Iconvault, Icomoon, iconfont, iconfont-tcl, Iconic, Iconos, Icons, ifanrx, iknow-qb_share_icons, &quot;Just Vector&quot;, JustVector, JustVectorRegular, LenovoSupport, Linecons, lobi-pc, LondonMM, Londonmmregular, mailFontIco, mainicon, Maki, Mainicon, &quot;Material Icons Extended&quot;, Material-Design-Icons, MENKSOF0, Menksoft2007, Menksoft2012, MenksoftQagan, Meteocons, MeteoconsRegular, Mfglabs, &quot;MFG Labs Iconset&quot;, Mfg_labs_iconsetregular, Modernpics, &quot;Modern Pictograms&quot;, MWF-MDL2, myfont, o365Icons, Office365Icons, &quot;OpenWeb Icons&quot;, Pe-icon-7-stroke, PulsarJS, RaphaelIcons, Rondo, sellerCenter, sdp-icons, Silkcons, SocialFoundicons, &quot;Social Foundicons&quot;, Socialico, &quot;Socialico Plus&quot;, &quot;Social Networking Icons&quot;, Sosa, &quot;Symbol Signs&quot;, &quot;Symbol Signs Basis set&quot;, Typicons, VideoJS, Weathercons, Websymbols, &quot;Web Symbols&quot;, &quot;Web Symbols Liga&quot;, wp-web-icons, Wpzoom, Yglyphs-legacy, youkuMobile, Zocial, &quot;PingFang SC&quot;, &quot;PingFang TC&quot;, &quot;PingFang HK&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Noto Sans CJK TC&quot;, &quot;Noto Sans CJK JP&quot;, &quot;Source Han Sans SC&quot;, &quot;Source Han Sans TC&quot;, &quot;Source Han Sans&quot;, SimSun, LowLevelEmoji, &quot;Segoe UI Symbol&quot;, &quot;Segoe UI Historic&quot;, Symbola, Quivira, Meiryo, &quot;Malgun Gothic&quot;, NSimSun, MingLiU, MingLiU_HKSCS, SimSun-ExtB, MingLiU-ExtB, MingLiU_HKSCS-ExtB, &quot;Nimbus Roman No9 L&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;WenQuanYi Zen Hei&quot;, &quot;Droid Sans Fallback&quot;, &quot;Hiragino Sans GB&quot;, Symbol, FZSongS, &quot;Simsun (Founder Extended)&quot;, &quot;Microsoft Himalaya&quot;, &quot;Microsoft New Tai Lue&quot;, &quot;Microsoft PhagsPa&quot;, &quot;Microsoft Tai Le&quot;, &quot;Microsoft Uighur&quot;, &quot;Microsoft Yi Baiti&quot;, &quot;Mongolian Baiti&quot;, &quot;Estrangelo Edessa&quot;, Ebrima, Euphemia, Nyala, &quot;Plantagenet Cherokee&quot;, sylfaen, &quot;Arial Unicode MS&quot;, Code2000, HanaMinA, HanaMinB, Unifont; font-size: 16px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">switch语句的问题在于重复（duplication）。你常会发现同样的switch语句散布 于不同地点。如果要为它添加一个新的子句，你必须找到所有switch语句 并修改它们。</span></div></li></ul><div><span style="font-size: 12pt; color: rgb(77, 77, 77);"><img src="Lecture 7 Refactoring_files/Image.png" type="image/png" data-filename="Image.png" width="635"/></span></div><div>利用多态可以解决这个问题</div><div><br/></div><div>Lazy Class 冗赘类</div><ul><li><div><span style="color: rgb(51, 51, 51); font-family: &quot;NoForceAllFonts By Plus.Func.Fonts.CN&quot;, &quot;NoForceAllFonts By 此处填写中文字体&quot;, &quot;NoForceAllFonts By DiyCnFEx&quot;, &quot;NoForceAllFonts By Microsoft YaHei&quot;, &quot;Catcat520.Lite.Latin&quot;, SDF-FixFontPos, SDF-FixFontPos-Space, LCnS, LEnS, LEnN, 此处填写英文字体, 此处填写font-family的名称, SDF-FixEnglishFonts, &quot;Segoe UI&quot;, Inconsolata, &quot;Envy Code R&quot;, &quot;Open Sans&quot;, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Lucida Grande&quot;, Ubuntu, Tahoma, Verdana, Menlo, Monaco, HighLevelEmoji, LCnS, &quot;/*UseJPFakeName By CnFonts&quot;, 此处填写中文字体, DiyCnFEx, &quot;SDF.FixScTcFonts&quot;, &quot;SDF.Hangul&quot;, &quot;Plus.Func.Fonts.CN&quot;, &quot;Microsoft YaHei&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, &quot;Microsoft JhengHei UI&quot;, &quot;Microsoft JhengHei&quot;, fp-font, AccessibilityFoundicons, &quot;Accessibility Foundicons&quot;, anchorjs-icons, Brandico, Brankic1979, &quot;Brankic 1979&quot;, Broccolidry, bundlestars, chagaan, CONDENSEicon, consumer-icons, Cuticons, dashicons, DA-brandicons, duotai, duotai-status, &quot;Dot Com&quot;, Ecoico, EightiesShades, ElegantIcons, Elusive, Elusive-Icons, Entypo, &quot;Entypo Social&quot;, Entypo-Social, &quot;Erler Dingbats&quot;, Et-line, FabricMDL2Icons, feedfont, FontAwesome, Fontelico, Fontello, Garqag, GeneralEnclosedFoundicons, &quot;General Enclosed Foundicons&quot;, GeneralFoundicons, &quot;General Foundicons&quot;, Gibson, &quot;Gibson Light&quot;, Gibson_lightbold, Gibson_lightitalic, Gibsonregular, &quot;Glyphicons Halflings&quot;, hb-icons, &quot;Heydings Controls&quot;, &quot;Heydings Icons&quot;, Houzz-Glyphs, icft_temai, icft_temai_index, Iconminia, Iconvault, Icomoon, iconfont, iconfont-tcl, Iconic, Iconos, Icons, ifanrx, iknow-qb_share_icons, &quot;Just Vector&quot;, JustVector, JustVectorRegular, LenovoSupport, Linecons, lobi-pc, LondonMM, Londonmmregular, mailFontIco, mainicon, Maki, Mainicon, &quot;Material Icons Extended&quot;, Material-Design-Icons, MENKSOF0, Menksoft2007, Menksoft2012, MenksoftQagan, Meteocons, MeteoconsRegular, Mfglabs, &quot;MFG Labs Iconset&quot;, Mfg_labs_iconsetregular, Modernpics, &quot;Modern Pictograms&quot;, MWF-MDL2, myfont, o365Icons, Office365Icons, &quot;OpenWeb Icons&quot;, Pe-icon-7-stroke, PulsarJS, RaphaelIcons, Rondo, sellerCenter, sdp-icons, Silkcons, SocialFoundicons, &quot;Social Foundicons&quot;, Socialico, &quot;Socialico Plus&quot;, &quot;Social Networking Icons&quot;, Sosa, &quot;Symbol Signs&quot;, &quot;Symbol Signs Basis set&quot;, Typicons, VideoJS, Weathercons, Websymbols, &quot;Web Symbols&quot;, &quot;Web Symbols Liga&quot;, wp-web-icons, Wpzoom, Yglyphs-legacy, youkuMobile, Zocial, &quot;PingFang SC&quot;, &quot;PingFang TC&quot;, &quot;PingFang HK&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Noto Sans CJK TC&quot;, &quot;Noto Sans CJK JP&quot;, &quot;Source Han Sans SC&quot;, &quot;Source Han Sans TC&quot;, &quot;Source Han Sans&quot;, SimSun, LowLevelEmoji, &quot;Segoe UI Symbol&quot;, &quot;Segoe UI Historic&quot;, Symbola, Quivira, Meiryo, &quot;Malgun Gothic&quot;, NSimSun, MingLiU, MingLiU_HKSCS, SimSun-ExtB, MingLiU-ExtB, MingLiU_HKSCS-ExtB, &quot;Nimbus Roman No9 L&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;WenQuanYi Zen Hei&quot;, &quot;Droid Sans Fallback&quot;, &quot;Hiragino Sans GB&quot;, Symbol, FZSongS, &quot;Simsun (Founder Extended)&quot;, &quot;Microsoft Himalaya&quot;, &quot;Microsoft New Tai Lue&quot;, &quot;Microsoft PhagsPa&quot;, &quot;Microsoft Tai Le&quot;, &quot;Microsoft Uighur&quot;, &quot;Microsoft Yi Baiti&quot;, &quot;Mongolian Baiti&quot;, &quot;Estrangelo Edessa&quot;, Ebrima, Euphemia, Nyala, &quot;Plantagenet Cherokee&quot;, sylfaen, &quot;Arial Unicode MS&quot;, Code2000, HanaMinA, HanaMinB, Unifont; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">你所创建的每一个class，都得有人去理解它、维护它，这些工作都是要花钱的。如 果一个class的所得不值其身价，它就应该消失。</span></div></li></ul><div><span style="font-size: 11pt; color: rgb(51, 51, 51);"><br/></span></div><div><span style="color: rgb(51, 51, 51);"><font style="font-size: 10pt;">Speculative Generality 夸夸其谈未来性</font></span></div><ul><li><div><span style="color: rgb(77, 77, 77); font-family: &quot;NoForceAllFonts By Plus.Func.Fonts.CN&quot;, &quot;NoForceAllFonts By 此处填写中文字体&quot;, &quot;NoForceAllFonts By DiyCnFEx&quot;, &quot;NoForceAllFonts By Microsoft YaHei&quot;, &quot;Catcat520.Lite.Latin&quot;, SDF-FixFontPos, SDF-FixFontPos-Space, LCnS, LEnS, LEnN, 此处填写英文字体, 此处填写font-family的名称, SDF-FixEnglishFonts, &quot;Segoe UI&quot;, Inconsolata, &quot;Envy Code R&quot;, &quot;Open Sans&quot;, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Lucida Grande&quot;, Ubuntu, Tahoma, Verdana, Menlo, Monaco, HighLevelEmoji, LCnS, &quot;/*UseJPFakeName By CnFonts&quot;, 此处填写中文字体, DiyCnFEx, &quot;SDF.FixScTcFonts&quot;, &quot;SDF.Hangul&quot;, &quot;Plus.Func.Fonts.CN&quot;, &quot;Microsoft YaHei&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, &quot;Microsoft JhengHei UI&quot;, &quot;Microsoft JhengHei&quot;, fp-font, AccessibilityFoundicons, &quot;Accessibility Foundicons&quot;, anchorjs-icons, Brandico, Brankic1979, &quot;Brankic 1979&quot;, Broccolidry, bundlestars, chagaan, CONDENSEicon, consumer-icons, Cuticons, dashicons, DA-brandicons, duotai, duotai-status, &quot;Dot Com&quot;, Ecoico, EightiesShades, ElegantIcons, Elusive, Elusive-Icons, Entypo, &quot;Entypo Social&quot;, Entypo-Social, &quot;Erler Dingbats&quot;, Et-line, FabricMDL2Icons, feedfont, FontAwesome, Fontelico, Fontello, Garqag, GeneralEnclosedFoundicons, &quot;General Enclosed Foundicons&quot;, GeneralFoundicons, &quot;General Foundicons&quot;, Gibson, &quot;Gibson Light&quot;, Gibson_lightbold, Gibson_lightitalic, Gibsonregular, &quot;Glyphicons Halflings&quot;, hb-icons, &quot;Heydings Controls&quot;, &quot;Heydings Icons&quot;, Houzz-Glyphs, icft_temai, icft_temai_index, Iconminia, Iconvault, Icomoon, iconfont, iconfont-tcl, Iconic, Iconos, Icons, ifanrx, iknow-qb_share_icons, &quot;Just Vector&quot;, JustVector, JustVectorRegular, LenovoSupport, Linecons, lobi-pc, LondonMM, Londonmmregular, mailFontIco, mainicon, Maki, Mainicon, &quot;Material Icons Extended&quot;, Material-Design-Icons, MENKSOF0, Menksoft2007, Menksoft2012, MenksoftQagan, Meteocons, MeteoconsRegular, Mfglabs, &quot;MFG Labs Iconset&quot;, Mfg_labs_iconsetregular, Modernpics, &quot;Modern Pictograms&quot;, MWF-MDL2, myfont, o365Icons, Office365Icons, &quot;OpenWeb Icons&quot;, Pe-icon-7-stroke, PulsarJS, RaphaelIcons, Rondo, sellerCenter, sdp-icons, Silkcons, SocialFoundicons, &quot;Social Foundicons&quot;, Socialico, &quot;Socialico Plus&quot;, &quot;Social Networking Icons&quot;, Sosa, &quot;Symbol Signs&quot;, &quot;Symbol Signs Basis set&quot;, Typicons, VideoJS, Weathercons, Websymbols, &quot;Web Symbols&quot;, &quot;Web Symbols Liga&quot;, wp-web-icons, Wpzoom, Yglyphs-legacy, youkuMobile, Zocial, &quot;PingFang SC&quot;, &quot;PingFang TC&quot;, &quot;PingFang HK&quot;, &quot;Noto Sans CJK SC&quot;, &quot;Noto Sans CJK TC&quot;, &quot;Noto Sans CJK JP&quot;, &quot;Source Han Sans SC&quot;, &quot;Source Han Sans TC&quot;, &quot;Source Han Sans&quot;, SimSun, LowLevelEmoji, &quot;Segoe UI Symbol&quot;, &quot;Segoe UI Historic&quot;, Symbola, Quivira, Meiryo, &quot;Malgun Gothic&quot;, NSimSun, MingLiU, MingLiU_HKSCS, SimSun-ExtB, MingLiU-ExtB, MingLiU_HKSCS-ExtB, &quot;Nimbus Roman No9 L&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;WenQuanYi Zen Hei&quot;, &quot;Droid Sans Fallback&quot;, &quot;Hiragino Sans GB&quot;, Symbol, FZSongS, &quot;Simsun (Founder Extended)&quot;, &quot;Microsoft Himalaya&quot;, &quot;Microsoft New Tai Lue&quot;, &quot;Microsoft PhagsPa&quot;, &quot;Microsoft Tai Le&quot;, &quot;Microsoft Uighur&quot;, &quot;Microsoft Yi Baiti&quot;, &quot;Mongolian Baiti&quot;, &quot;Estrangelo Edessa&quot;, Ebrima, Euphemia, Nyala, &quot;Plantagenet Cherokee&quot;, sylfaen, &quot;Arial Unicode MS&quot;, Code2000, HanaMinA, HanaMinB, Unifont; font-size: 16px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">有人说『噢，我想我们总有一天需要做这事』并因而企图以各式各样的挂勾（hooks）和特殊情况来处理一 些非必要的事情，这种坏味道就出现了。那么做的结果往往造成系统更难理解和维护。如果所有装置都会被用到，那就值得那么做；如果用不到，就不值得。用不上的装置只会挡你的路，所以，把它搬开吧。</span></div></li></ul><div><span style="font-size: 12pt; color: rgb(77, 77, 77);"><br/></span></div><div><span style="color: rgb(77, 77, 77);"><font style="font-size: 10pt;">Temporary Field 令人迷惑的暂时值域</font></span></div><ul><li><div><span style="color: rgb(77, 77, 77);">若对象中的一个变量只在某种特殊情况下被赋值, 其他时候都为空, 则应该把它提取出来单独作为一个类. </span><br/></div></li></ul><div><br/></div></div></span>
</div></body></html> 